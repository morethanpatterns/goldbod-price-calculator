<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script defer src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<title>Gold Amount Calculator â€” Vertical (Accounting Clean)</title>
<style>
  :root{ --bg:#ffffff; --card:#ffffff; --line:#e5e7eb; --muted:#4b5563; --fg:#111827; --gold:#C59B0B; }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:#111827}
  .wrap{max-width:620px;margin:0 auto;padding:18px}
  h1{margin:0 0 6px;font-size:clamp(20px,4vw,32px);text-align:center;color:var(--gold);font-weight:800;letter-spacing:1px}
  .stamp{font-size:13px;color:#374151;text-align:center;margin:0 0 14px}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
  label{display:block;margin-top:12px;color:#4b5563;font-size:12px}
  input{width:100%;padding:12px;border-radius:10px;border:1px solid #d1d5db;background:#ffffff;color:#111827;font-size:16px;text-align:right}
  input[readonly]{background:#f9fafb}
  input:focus{outline:none;border-color:#f59e0b;box-shadow:0 0 0 3px rgba(245,158,11,.25)}
  .out{margin-top:12px;padding:12px;border:1px dashed #e5e7eb;border-radius:12px;display:flex;justify-content:space-between;align-items:center;background:#fafafa}
  .out .label{color:#374151;font-size:12px}
  .out .value{font-weight:800;font-variant-numeric:tabular-nums;letter-spacing:.2px}
  .big{font-size:22px;color:#065f46}
  .btns{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
  .btn{appearance:none;border:1px solid #d1d5db;background:linear-gradient(135deg,#facc15,#f59e0b);color:#000;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
</style>
</head>
<body>
  <div class="wrap">
    <h1>Gold Amount Calculator</h1>
    <div class="stamp">&#x1F4C5; <span id="timestamp">&mdash;</span></div>

    <div id="cardContainer" class="card">
      <!-- Inputs -->
      <label for="top">Top (g)</label>
      <input id="top" type="number" step="0.01" inputmode="decimal" value="0" />

      <label for="down">Down (g)</label>
      <input id="down" type="number" step="0.01" inputmode="decimal" value="0" />

      <label for="price">Price (GHS/Lb)</label>
      <input id="price" type="number" step="0.01" inputmode="decimal" value="0" />

      <!-- Outputs -->
      <div class="out"><div class="label">Pounds (Lb)</div><div class="value" id="pounds">0.00</div></div>
      <div class="out"><div class="label">Density</div><div class="value" id="density">0.00</div></div>
      <div class="out"><div class="label">Karat (K)</div><div class="value" id="karat">0.00</div></div>
      <div class="out">
        <div class="label">Amount (GHS)</div>
        <div class="value big" id="amount">GHS 0.00</div>
      </div>

      <div class="btns">
        <button class="btn" id="reset">Reset</button>
        <button class="btn" id="share">Share / Copy Link</button>
        <button class="btn" id="copyText">Copy Text</button>
        <button class="btn" id="printPdf">Download Screenshot</button>
      </div>
    </div>
    <p id="actionMessage" role="status" aria-live="polite"></p>
  </div>

  <!-- Share fallback modal -->
  <div class="modal" id="modal" style="position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:16px">
    <div class="box" style="background:#fff;border-radius:12px;max-width:560px;width:100%;padding:16px;border:1px solid #e5e7eb;box-shadow:0 10px 28px rgba(0,0,0,.2)">
      <h3 style="margin:0 0 8px;color:#111827">Copy this link</h3>
      <textarea id="linkBox" readonly style="width:100%;height:90px;border:1px solid #d1d5db;border-radius:8px;padding:10px;font-size:14px"></textarea>
      <div class="actions" style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
        <button id="copyBtn" style="padding:8px 12px;border-radius:8px;border:1px solid #d1d5db;background:#f3f4f6;cursor:pointer">Copy</button>
        <button id="closeBtn" style="padding:8px 12px;border-radius:8px;border:1px solid #d1d5db;background:#f3f4f6;cursor:pointer">Close</button>
      </div>
    </div>
  </div>

<script>
  const $ = id => document.getElementById(id);
  function trunc2(x){ return Math.trunc(x*100)/100; }
  function trunc0(x){ return Math.trunc(x); }

  function fmtAccounting(n){
    const abs = Math.abs(n);
    const withDec = abs.toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2});
    const body = (n < 0) ? `(${withDec})` : withDec;
    return `GHS ${body}`;
  }

  let messageTimer;
  function showMessage(text,type='success'){
    const el=$('actionMessage');
    if(!el)return;
    const colors={success:'#047857',info:'#2563eb',error:'#b91c1c'};
    el.textContent=text;
    el.style.color=colors[type]||colors.success;
    el.style.display='block';
    clearTimeout(messageTimer);
    messageTimer=setTimeout(()=>{el.style.display='none';},4000);
  }
  function hideMessage(){
    const el=$('actionMessage');
    if(!el)return;
    el.style.display='none';
    clearTimeout(messageTimer);
    messageTimer=undefined;
  }

  function pad2(n){ return n<10 ? '0'+n : ''+n; }
  function ordinal(n){ const s=['th','st','nd','rd'], v=n%100; return n+(s[(v-20)%10]||s[v]||s[0]); }
  function stampString(d){
    const days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
    const months=['January','February','March','April','May','June','July','August','September','October','November','December'];
    const h=d.getHours(), m=pad2(d.getMinutes());
    const ampm = h===0? '12' : (h>12? (h-12) : h);
    const suffix = h>=12 ? 'pm' : 'am';
    return `${days[d.getDay()]}, ${ordinal(d.getDate())} ${months[d.getMonth()]} ${d.getFullYear()} @ ${ampm}:${m}${suffix}.`;
  }
  function updateClock(){ $('timestamp').textContent = stampString(new Date()); }

  function nf2(x){ return trunc2(x).toFixed(2); }

  function calc(){
    const top = parseFloat($('top').value);
    const down = parseFloat($('down').value);
    const price = parseFloat($('price').value);

    const ready = isFinite(top) && isFinite(down) && isFinite(price) && down !== 0 && top !== 0;
    if(!ready){
      $('pounds').textContent='0.00';
      $('density').textContent='0.00';
      $('karat').textContent='0.00';
      $('amount').textContent=fmtAccounting(0);
      return;
    }

    const pounds = trunc2(top/7.75);
    const density = trunc2(top/down);
    const karat = trunc2(((density - 10.51) * 52.838) / density);
    const amount = trunc0((karat/23) * price * pounds);

    $('pounds').textContent = nf2(pounds);
    $('density').textContent = nf2(density);
    $('karat').textContent = nf2(karat);
    $('amount').textContent = fmtAccounting(amount);
  }

  ['top','down','price'].forEach(id => {
    const el = $(id);
    el.addEventListener('focus', () => { if(el.value === '0') el.value=''; });
    el.addEventListener('blur', () => { if(el.value === '') el.value='0'; calc(); });
    el.addEventListener('input', calc);
  });

  $('reset').addEventListener('click', () => { $('top').value='0'; $('down').value='0'; $('price').value='0'; calc(); });

  function buildLink(){ const p=new URLSearchParams({ top:$('top').value, down:$('down').value, price:$('price').value }); return location.origin+location.pathname+'?'+p.toString(); }
  $('share').addEventListener('click', async ()=>{
    hideMessage();
    const url = buildLink();
    if(navigator.share){ try{ await navigator.share({title:'Gold Amount Calculator', url}); showMessage('Share dialog opened.','info'); return; }catch(e){} }
    if(navigator.clipboard && navigator.clipboard.writeText){ try{ await navigator.clipboard.writeText(url); showMessage('Link copied to clipboard.'); return; }catch(e){ showMessage('Copy failed. Use Ctrl+C or Cmd+C.','error'); } }
    const modal=$('modal'); const box=$('linkBox'); box.value=url; modal.style.display='flex'; box.focus(); box.select();
    showMessage('Copy the link below.','info');
  });
  $('copyBtn').addEventListener('click', ()=>{ const box=$('linkBox'); box.select(); try{ document.execCommand('copy'); showMessage('Link copied to clipboard.'); }catch(e){ showMessage('Copy failed. Use Ctrl+C or Cmd+C.','error'); } });
  $('closeBtn').addEventListener('click', ()=>{ $('modal').style.display='none'; });

  $('copyText').addEventListener('click', async ()=>{
    hideMessage();
    const nowStamp = stampString(new Date());
    const t = $('top').value||'0', d = $('down').value||'0', p = $('price').value||'0';
    const pounds = $('pounds').textContent||'0.00', density = $('density').textContent||'0.00', karat = $('karat').textContent||'0.00', amount = $('amount').textContent||'GHS 0.00';
    const text = `Gold Amount Calculator 
${nowStamp}

Top (g): ${t}
Down (g): ${d}
Price (GHS/Lb): ${p}

Pounds (Lb): ${pounds}
Density: ${density}
Karat (K): ${karat}

Amount (GHS): ${amount}`;
    try{ await navigator.clipboard.writeText(text); showMessage('Details copied to clipboard.'); }
    catch(e){ const tmp=document.createElement('textarea'); tmp.value=text; document.body.appendChild(tmp); tmp.select(); try{ document.execCommand('copy'); showMessage('Details copied to clipboard.'); }catch(e2){ showMessage('Copy failed. Use Ctrl+C or Cmd+C.','error'); } document.body.removeChild(tmp); }
  });

  async function triggerScreenshot(){
    hideMessage();
    const target=document.querySelector('.wrap');
    if(!target){
      showMessage('Calculator not found.','error');
      return;
    }

    if(typeof html2canvas!=='function'){
      showMessage('Screenshot tool failed to load. Reload the page and try again.','error');
      return;
    }

    try{
      const canvas=await html2canvas(target,{
        backgroundColor:'#ffffff',
        scale:Math.min(window.devicePixelRatio||1,3),
        useCORS:true
      });
      const dataUrl=canvas.toDataURL('image/png');
      const link=document.createElement('a');
      const stamp=new Date().toISOString().replace(/[:.]/g,'-');
      link.href=dataUrl;
      link.download='gold-amount-calculator-' + stamp + '.png';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      showMessage('Screenshot downloaded.','success');
    }catch(err){
      console.error(err);
      showMessage('Screenshot failed. Try again or capture it manually.','error');
    }
  }

  $('printPdf').addEventListener('click',triggerScreenshot);

  updateClock(); setInterval(updateClock, 1000);
  (function(){ const q=new URLSearchParams(location.search); if(q.has('top')) $('top').value=q.get('top'); if(q.has('down')) $('down').value=q.get('down'); if(q.has('price')) $('price').value=q.get('price'); })();
  calc();
</script>
</body>
</html>














